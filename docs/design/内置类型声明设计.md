# C^ 内置类型声明设计

## 1. 设计理念

C^ 的内置原子类型在编译器内部被实现为**特殊的结构体**，这些结构体定义了类型的静态属性。用户无法直接实例化这些结构体，但可以访问它们的静态属性。

这种设计的优势：
1. **统一性**：内置类型和用户定义类型使用相同的语法和访问模式
2. **可扩展性**：未来可以轻松添加新的静态属性或方法
3. **清晰性**：类型声明与普通结构体声明类似，易于理解

## 2. 语法设计

### 2.1 基本语法

内置类型通过特殊的 `struct` 声明定义，使用 `static get` 来定义静态属性：

```cpp
// int 类型的声明（编译器内部实现）
struct Int32 {
    // 静态属性：最大值
    static get max_value -> Int32 => 2147483647;
    
    // 静态属性：最小值
    static get min_value -> Int32 => -2147483648;
    
    // 静态属性：位数
    static get bits -> long => 32;
    
    // 静态属性：字节大小
    static get size -> long => 4;
    
    // 静态属性：是否有符号
    static get is_signed -> bool => true;
    
    // 静态属性：是否为整数
    static get is_integer -> bool => true;
    
    // 静态属性：是否为浮点数
    static get is_floating -> bool => false;
}
```

### 2.2 访问语法

用户通过类型名直接访问这些静态属性：

```cpp
// 访问静态属性
long max = int.max_value;
long min = int.min_value;
long bits = int.bits;
long size = int.size;
bool signed = int.is_signed;
```

## 3. 完整的内置类型声明

### 3.1 整数类型

#### 3.1.1 byte (无符号 8 位)

```cpp
struct Byte {
    static get max_value -> Byte => 255;
    static get min_value -> Byte => 0;
    static get bits -> long => 8;
    static get size -> long => 1;
    static get is_signed -> bool => false;
    static get is_integer -> bool => true;
    static get is_floating -> bool => false;
}
```

#### 3.1.2 sbyte (有符号 8 位)

```cpp
struct SByte {
    static get max_value -> SByte => 127;
    static get min_value -> SByte => -128;
    static get bits -> long => 8;
    static get size -> long => 1;
    static get is_signed -> bool => true;
    static get is_integer -> bool => true;
    static get is_floating -> bool => false;
}
```

#### 3.1.3 short (有符号 16 位)

```cpp
struct Int16 {
    static get max_value -> Int16 => 32767;
    static get min_value -> Int16 => -32768;
    static get bits -> long => 16;
    static get size -> long => 2;
    static get is_signed -> bool => true;
    static get is_integer -> bool => true;
    static get is_floating -> bool => false;
}
```

#### 3.1.4 ushort (无符号 16 位)

```cpp
struct UInt16 {
    static get max_value -> UInt16 => 65535;
    static get min_value -> UInt16 => 0;
    static get bits -> long => 16;
    static get size -> long => 2;
    static get is_signed -> bool => false;
    static get is_integer -> bool => true;
    static get is_floating -> bool => false;
}
```

#### 3.1.5 int (有符号 32 位)

```cpp
struct Int32 {
    static get max_value -> Int32 => 2147483647;
    static get min_value -> Int32 => -2147483648;
    static get bits -> long => 32;
    static get size -> long => 4;
    static get is_signed -> bool => true;
    static get is_integer -> bool => true;
    static get is_floating -> bool => false;
}
```

#### 3.1.6 uint (无符号 32 位)

```cpp
struct UInt32 {
    static get max_value -> UInt32 => 4294967295;
    static get min_value -> UInt32 => 0;
    static get bits -> long => 32;
    static get size -> long => 4;
    static get is_signed -> bool => false;
    static get is_integer -> bool => true;
    static get is_floating -> bool => false;
}
```

#### 3.1.7 long (有符号 64 位)

```cpp
struct Int64 {
    static get max_value -> Int64 => 9223372036854775807;
    static get min_value -> Int64 => -9223372036854775808;
    static get bits -> long => 64;
    static get size -> long => 8;
    static get is_signed -> bool => true;
    static get is_integer -> bool => true;
    static get is_floating -> bool => false;
}
```

#### 3.1.8 ulong (无符号 64 位)

```cpp
struct UInt64 {
    static get max_value -> UInt64 => 18446744073709551615;
    static get min_value -> UInt64 => 0;
    static get bits -> long => 64;
    static get size -> long => 8;
    static get is_signed -> bool => false;
    static get is_integer -> bool => true;
    static get is_floating -> bool => false;
}
```

### 3.2 浮点类型

#### 3.2.1 float (单精度 32 位)

```cpp
struct Float32 {
    static get max_value -> Float32 => 3.40282347e+38f;
    static get min_value -> Float32 => 1.17549435e-38f;
    static get epsilon -> Float32 => 1.192092896e-07f;
    static get bits -> long => 32;
    static get size -> long => 4;
    static get is_signed -> bool => true;
    static get is_integer -> bool => false;
    static get is_floating -> bool => true;
}
```

#### 3.2.2 double (双精度 64 位)

```cpp
struct Float64 {
    static get max_value -> Float64 => 1.7976931348623157e+308;
    static get min_value -> Float64 => 2.2250738585072014e-308;
    static get epsilon -> Float64 => 2.2204460492503131e-16;
    static get bits -> long => 64;
    static get size -> long => 8;
    static get is_signed -> bool => true;
    static get is_integer -> bool => false;
    static get is_floating -> bool => true;
}
```

#### 3.2.3 fp16 (半精度 16 位)

```cpp
struct Float16 {
    static get max_value -> Float16 => 65504.0h;
    static get min_value -> Float16 => 6.103515625e-5h;
    static get epsilon -> Float16 => 9.765625e-4h;
    static get bits -> long => 16;
    static get size -> long => 2;
    static get is_signed -> bool => true;
    static get is_integer -> bool => false;
    static get is_floating -> bool => true;
}
```

#### 3.2.4 bf16 (脑浮点 16 位)

```cpp
struct BFloat16 {
    static get max_value -> BFloat16 => 3.38953139e+38bf;
    static get min_value -> BFloat16 => 1.17549435e-38bf;
    static get epsilon -> BFloat16 => 7.8125e-3bf;
    static get bits -> long => 16;
    static get size -> long => 2;
    static get is_signed -> bool => true;
    static get is_integer -> bool => false;
    static get is_floating -> bool => true;
}
```

### 3.3 其他类型

#### 3.3.1 bool (布尔类型)

```cpp
struct Boolean {
    static get true_value -> Boolean => true;
    static get false_value -> Boolean => false;
    static get bits -> long => 8;
    static get size -> long => 1;
    static get is_signed -> bool => false;
    static get is_integer -> bool => false;
    static get is_floating -> bool => false;
}
```

#### 3.3.2 char (字符类型)

```cpp
struct Char {
    static get max_value -> Char => 0x10FFFF;
    static get min_value -> Char => 0;
    static get bits -> long => 32;
    static get size -> long => 4;
    static get is_signed -> bool => false;
    static get is_integer -> bool => false;
    static get is_floating -> bool => false;
}
```

#### 3.3.3 LiteralView (字面量视图类型)

```cpp
struct LiteralView {
    // 字段：编译器内部维护，用户无法直接访问
    byte!^ ptr;  // 指向只读字节数据的指针
    long len;     // 数据长度（字节数）
}
```

## 4. 类型别名映射

为了方便使用，C^ 提供了简短的类型别名：

```cpp
// 整数类型
using byte = Byte;
using sbyte = SByte;
using short = Int16;
using ushort = UInt16;
using int = Int32;
using uint = UInt32;
using long = Int64;
using ulong = UInt64;

// 浮点类型
using float = Float32;
using double = Float64;
using fp16 = Float16;
using bf16 = BFloat16;

// 其他类型
using bool = Boolean;
using char = Char;
```

## 5. 使用示例

### 5.1 基本使用

```cpp
// 访问整数类型属性
func print_int_info() {
    print("int max: " + int.max_value);
    print("int min: " + int.min_value);
    print("int bits: " + int.bits);
    print("int size: " + int.size);
}

// 访问浮点类型属性
func print_float_info() {
    print("double max: " + double.max_value);
    print("double epsilon: " + double.epsilon);
}
```

### 5.2 编译期使用

```cpp
// 编译期数组大小
int[int.size] buffer;  // int[4] buffer

// 编译期边界检查
comptime {
    if (long.bits != 64) {
        @error("long must be 64 bits");
    }
}

// 编译期选择类型
comptime func choose_type(long required_bits) -> type {
    if (required_bits <= byte.bits) return byte;
    if (required_bits <= short.bits) return short;
    if (required_bits <= int.bits) return int;
    return long;
}
```

### 5.3 泛型编程

```cpp
// 泛型函数：获取类型的最大值
func get_max<T>() -> T {
    return T.max_value;
}

// 使用
int max_int = get_max<int>();
double max_double = get_max<double>();
```

## 6. 编译器实现要点

### 6.1 特殊处理

1. **不可实例化**：这些内置结构体不能被用户实例化
2. **类型别名优先**：编译器优先识别简短别名（如 `int`）而非完整名称（如 `Int32`）
3. **静态属性直接求值**：所有静态属性在编译期直接求值，不生成运行时代码

### 6.2 与反射系统的关系

类型静态属性和反射系统可以互补：
- `int.max_value` - 简洁访问常用属性
- `@int.max_value` - 元编程中访问，支持更复杂的操作

## 7. 设计优势总结

1. **统一语法**：内置类型和用户类型使用相同的属性访问语法
2. **零开销**：完全编译期处理，无运行时成本
3. **可扩展**：未来可以轻松添加新属性
4. **自文档化**：类型声明本身就是文档
5. **C# 风格**：借鉴了 C# 的成熟设计，但更简洁
