
# 模块系统开发计划（2026-02-16）

## 目标
实现完整的模块导入系统，让 `import std.io.Console;` 这样的语句能够真正工作！

## 核心流程
1. **模块路径转文件路径**
   - `std.io.Console` → `stdlib/std/io/Console.ch`
   - 查找顺序：优先在用户指定的 --stdlib-path 查找，然后在编译器默认路径查找
2. **模块文件解析**
   - 读取并解析 .ch 模块文件
   - 提取其中的声明
3. **符号导入**
   - 将模块中的 public 符号导入到当前符号表
4. **循环导入检测**
   - 防止 A 导入 B，B 导入 A 这样的循环

## 实现步骤（优先级）
### 1. 模块路径到文件路径转换（当前）
- 函数 `std::filesystem::path modulePathToFilePath(const std::vector&lt;std::string&gt;&amp; modulePath, const std::string&amp; stdlibPath)`
- 测试用例：["std", "io", "Console"] → "stdlib/std/io/Console.ch"

### 2. 模块文件读取和解析
- 从模块导入语句中提取模块路径
- 尝试打开对应的 .ch 文件
- 使用解析器解析模块文件，得到它的 AST

### 3. 符号收集和导入
- 遍历模块 AST，收集所有的 public 声明
- 将这些符号添加到当前的符号表中

### 4. 循环导入防护
- 记录已加载的模块，防止重复加载和循环加载

## 技术栈
- **C++17 filesystem**：用于路径操作和文件存在性检查
- **std::unordered_set**：记录已加载模块的集合

## 标准库文件结构（已存在）
```
stdlib/
└── std/
    ├── Predef.ch
    ├── core/
    │   ├── Types.ch
    │   └── LiteralView.ch
    └── io/
        └── Console.ch
```

## 测试用例
测试文件：`examples/hello_std.ch`
```cpp
module main;

import std.io.Console;

func main() {
    Console.println("Hello from std.io.Console!");
}
```
