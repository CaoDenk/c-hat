# C^ (C-Hat) 项目结构

## 1. 当前项目结构

### 1.1 根目录结构

```
c-hat/       # 项目根目录
├── src/      # 源代码
├── include/  # 公共头文件
├── lib/      # 标准库
├── tests/    # 测试
├── docs/     # 文档
├── build/    # 构建输出
└── CMakeLists.txt
```

---

### 1.2 源代码目录结构 (实际状态)

```
src/
├── 62个 .h 头文件    # 包含基础类型和声明
├── 8个 .cpp 源文件   # 目前主要是基础框架代码
└── (待重构为子目录结构)

# 计划中的目录结构 (Phase 1开始后实施):
src/
├── lexer/           # 词法分析器 (待创建)
├── parser/          # 语法分析器 (待创建)  
├── ast/             # 抽象语法树 (待创建)
├── codegen/         # 代码生成器 (待创建)
├── types/           # 类型系统 (待创建)
├── semantic/        # 语义分析 (待创建)
└── main.cpp         # 编译器入口 (待重写)
```

---

### 1.3 文档目录结构

```
docs/
├── design/  # 设计文档
│   ├── 语法.md
│   ├── 指针设计.md
│   ├── 数组设计.md
│   └── ...
└── dev/     # 开发文档
    ├── 开发方案.md
    ├── 项目结构.md
    ├── 开发环境搭建.md
    └── ...
```

---

## 2. 目录说明

项目采用清晰的目录结构，将源代码、头文件、标准库、测试和文档分离。

*   **src/**：所有源代码，包含编译器的核心实现。
*   **include/**：公共头文件，供其他项目引用。
*   **lib/**：标准库实现（如字符串、容器等）。
*   **tests/**：测试代码，包含单元测试、集成测试等。
*   **docs/**：设计文档和用户手册，分为设计文档和开发文档。
*   **build/**：构建输出目录，包含编译生成的可执行文件和库。

---

## 3. 核心模块说明

### 3.1 项目基础设施 ✅

*   **位置**：项目根目录
*   **功能**：CMake构建系统、目录结构、基础配置
*   **实现**：已完成，可正常构建

### 3.2 设计文档 ✅

*   **位置**：`docs/design/`
*   **功能**：完整的c^语言语言规范
*   **实现**：已完成，涵盖语法、类型系统、模块系统等27个设计文档

### 3.3 开发环境文档 ✅

*   **位置**：`docs/dev/`
*   **功能**：环境搭建、构建说明
*   **实现**：已完成

### 3.4 编译器核心模块 ❌ (Phase 1目标)

| 模块 | 计划位置 | 功能 | 状态 |
|------|----------|------|------|
| 词法分析器 | `src/lexer/` | 识别Token流 | 未开始 |
| 语法分析器 | `src/parser/` | 构建AST | 未开始 |
| 抽象语法树 | `src/ast/` | 语法结构表示 | 未开始 |
| 代码生成器 | `src/codegen/` | LLVM IR生成 | 未开始 |
| 类型系统 | `src/types/` | 类型检查与推导 | Phase 2 |
| 语义分析 | `src/semantic/` | 语义正确性检查 | Phase 2 |

### 3.5 标准库 ❌ (Phase 4目标)

*   **位置**：`lib/`
*   **功能**：字符串、容器、IO等核心功能
*   **实现**：计划中

---

## 4. 构建系统

项目使用 CMake 作为构建系统，配置文件为根目录下的 `CMakeLists.txt`。

### 4.1 构建步骤

1.  **创建构建目录**：`mkdir build && cd build`
2.  **配置项目**：`cmake ..`
3.  **编译项目**：`cmake --build .`
4.  **运行测试**：`./c_hat_parser.exe`

### 4.2 构建配置

*   **C++ 标准**：C++20（支持 std::format）
*   **输出目录**：`build/`
*   **目标**：`c_hat_parser.exe`

---

## 5. 开发流程

### 5.1 代码风格

*   **命名风格**：
    *   类型名：PascalCase
    *   函数名：snake_case
    *   变量名：snake_case
    *   常量名：UPPER_SNAKE_CASE
*   **缩进**：4 空格
*   **每行长度**：不超过 100 字符
*   **注释**：Doxygen 风格

### 5.2 版本控制

*   **分支策略**：
    *   main：主分支，保持稳定
    *   develop：开发分支，集成新功能
    *   feature/*：特性分支，开发具体功能
    *   bugfix/*：修复分支，解决问题
*   **提交规范**：
    ```
    <type>(<scope>): <subject>
    
    <body>
    
    <footer>
    ```

### 5.3 代码审查

*   **Pull Request**：所有代码变更通过 PR 提交
*   **审查标准**：
    *   代码正确性
    *   性能影响
    *   安全性
    *   可维护性
    *   测试覆盖

---

## 6. 总结

C^ (C-Hat) 项目采用清晰、模块化的目录结构，便于代码的组织和维护。当前已完成词法分析器、语法分析器和抽象语法树的实现，后续将逐步实现类型系统、语义分析和代码生成等模块。

项目的设计哲学是：信任程序员，但提供工具。通过引入现代关键字和统一的语法，C^ 既消除了 C++ 的歧义，又保持了语法的简洁，为系统编程提供了更清晰、更安全、更现代的选择。| 特性     | C++               | C^            |
| -------- | ----------------- | ------------- |
| 类       | `class`           | `class`       |
| 函数     | `function`/`func` | `func`        |
| 构造函数 | 无                | `constructor` |
| 析构函数 | `~Class`          | `destructor`  |
| 继承     | `:`               | `extends`     |
| 接口     | `interface`       | `interface`   |
| 泛型     | `<>`              | `<>`          |
| 模块     | 无                | `module`      |
| 导入     | 无                | `import`      || 特性 | C++     | C^  |
| ---- | ------- | --- |
| 类   | `class` | `   |